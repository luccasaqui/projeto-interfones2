<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GERADOR DE DADOS DO INTERFONE INTELIGENTE</title>
    <!-- Inclui o Tailwind CSS para um design limpo e responsivo -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Montserrat:wght@700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #2d3748; /* Cor de fundo cinza-escuro */
        }
        .loomy-logo {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
        }
        .loomy-logo .green {
            color: #8cff00; /* Cor verde do logo */
            letter-spacing: -5px; /* Ajuste para o "oo" do logo */
        }
        .loomy-logo .gray {
            color: #d1d5db; /* Cor cinza claro para o fundo escuro */
        }
        .loomy-logo .smart {
            font-size: 1rem;
            font-weight: 400;
            color: #a0aec0;
        }
        .animated-pulse {
            animation: pulse 1s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        
        /* Estilos da animação de carregamento */
        .search-animation {
            position: relative;
            width: 150px;
            height: 80px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto; /* Centraliza a animação */
        }
        .search-animation .icon-magnifier {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            fill: #8cff00; /* Ícone na cor do logo */
            z-index: 10;
        }
        .search-animation .card-group {
            position: absolute;
            top: 0;
            left: 100%;
            display: flex;
            gap: 10px;
            animation: card-slide 3s linear infinite;
        }
        .search-animation .card {
            width: 50px;
            height: 70px;
            background-color: #4a5568;
            border-radius: 6px;
            border: 1px solid #718096;
            flex-shrink: 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        @keyframes card-slide {
            0% { transform: translateX(0); }
            100% { transform: translateX(-200%); }
        }
        
        /* Custom message box styling */
        .message-box {
            padding: 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            line-height: 1.25rem;
            text-align: center;
            margin-top: 1rem;
        }
        .message-box.error {
            background-color: #fee2e2;
            color: #991b1b;
        }
        .message-box.info {
            background-color: #fef3c7;
            color: #92400e;
        }
        .message-box.success {
            background-color: #d1fae5;
            color: #065f46;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">

    <!-- Logotipo Loomy estático -->
    <div class="mb-8 text-center">
        <h1 class="loomy-logo text-6xl md:text-7xl lg:text-8xl">
            <span class="gray">L</span><span class="green">oo</span><span class="gray">my</span>
        </h1>
        <p class="smart text-base md:text-lg">Smart Solutions</p>
    </div>

    <div class="bg-gray-800 text-gray-100 p-8 rounded-2xl shadow-lg border border-gray-700 w-full max-w-md mx-auto">
        <h1 class="text-3xl font-bold text-center text-gray-100 mb-6">GERADOR DE DADOS DO INTERFONE INTELIGENTE</h1>

        <!-- Seção de Autenticação - Visível por padrão -->
        <div id="authSection" class="space-y-4">
            <h2 class="text-xl font-semibold text-center mb-4">Validação de Dados</h2>

            <div>
                <label for="nomeCompleto" class="block text-sm font-medium">Nome Completo</label>
                <input type="text" id="nomeCompleto" class="mt-1 block w-full px-3 py-2 border border-gray-600 bg-gray-700 text-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm" placeholder="Nome completo">
            </div>

            <div>
                <label for="cpf" class="block text-sm font-medium">CPF</label>
                <input type="text" id="cpf" class="mt-1 block w-full px-3 py-2 border border-gray-600 bg-gray-700 text-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm" placeholder="000.000.000-00">
            </div>

            <div>
                <label for="numero" class="block text-sm font-medium">Número</label>
                <input type="text" id="numero" class="mt-1 block w-full px-3 py-2 border border-gray-600 bg-gray-700 text-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm" placeholder="(DD) 99999-9999">
            </div>

            <div id="mainButtonsContainer" class="flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-2">
                <button id="avancarBtn" class="w-full md:flex-1 bg-green-600 text-white py-2 px-4 rounded-md shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200">
                    Avançar
                </button>
                <button id="devSkipBtn" class="w-full md:flex-1 bg-gray-500 text-white py-2 px-4 rounded-md shadow-sm hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-400 transition-colors duration-200">
                    PULAR (DEV)
                </button>
            </div>
            
            <div id="loadingAnimation" class="hidden loading-animation-container mt-4 flex flex-col items-center">
                <div class="search-animation">
                    <div class="icon-magnifier">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                        </svg>
                    </div>
                    <div class="card-group">
                        <div class="card bg-gray-300 rounded-lg shadow-md flex items-center justify-center text-gray-500 font-bold">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-8 h-8 text-gray-400">
                                <path fill-rule="evenodd" d="M7.5 6a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM3.751 20.105a8.25 8.25 0 0 1 16.498 0 .75.75 0 0 1-.437.695A18.683 18.683 0 0 1 12 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 0 1-.437-.695Z" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <div class="card bg-gray-300 rounded-lg shadow-md flex items-center justify-center text-gray-500 font-bold">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-8 h-8 text-gray-400">
                                <path fill-rule="evenodd" d="M7.5 6a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM3.751 20.105a8.25 8.25 0 0 1 16.498 0 .75.75 0 0 1-.437.695A18.683 18.683 0 0 1 12 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 0 1-.437-.695Z" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <div class="card bg-gray-300 rounded-lg shadow-md flex items-center justify-center text-gray-500 font-bold">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-8 h-8 text-gray-400">
                                <path fill-rule="evenodd" d="M7.5 6a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM3.751 20.105a8.25 8.25 0 0 1 16.498 0 .75.75 0 0 1-.437.695A18.683 18.683 0 0 1 12 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 0 1-.437-.695Z" clip-rule="evenodd" />
                            </svg>
                        </div>
                    </div>
                </div>
                <span class="mt-4 text-gray-300 text-sm font-medium text-center">Aguarde um momentinho enquanto localizamos o seu cadastro.</span>
            </div>
            
            <div id="authMessageBox" class="message-box hidden"></div>
        </div>

        <!-- Seção de Confirmação de Dados -->
        <div id="dataConfirmationSection" class="space-y-4 hidden">
            <h2 class="text-xl font-semibold text-center mb-4">Confirmação de Dados</h2>
            <div id="confirmedDataDisplay" class="p-4 bg-gray-700 rounded-lg border border-gray-600">
                <p class="font-medium">Confirme se estes dados correspondem ao seu endereço:</p>
                <p><span class="font-bold">Condomínio:</span> <span id="confirmedCondominio"></span></p>
                <p><span class="font-bold">Bloco:</span> <span id="confirmedBloco"></span></p>
                <p><span class="font-bold">Apartamento:</span> <span id="confirmedApartamento"></span></p>
            </div>
            <div class="flex flex-col space-y-2">
                <button id="confirmYesBtn" class="w-full bg-green-600 text-white py-2 px-4 rounded-md shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200">
                    Sim, estes são meus dados
                </button>
                <button id="confirmNoBtn" class="w-full bg-red-600 text-white py-2 px-4 rounded-md shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-200">
                    Não, não são meus dados
                </button>
            </div>
            <div id="confirmationMessageBox" class="message-box hidden"></div>
        </div>
        
        <!-- Nova Seção para Escolha do Ponto -->
        <div id="pontoSelectionSection" class="space-y-4 hidden">
            <h2 class="text-xl font-semibold text-center mb-4">Selecione o Ponto</h2>
            <div class="p-4 bg-gray-700 rounded-lg border border-gray-600">
                <p class="font-medium">Para qual ponto você deseja gerar os dados?</p>
                <div class="flex flex-col space-y-2 mt-4">
                    <label class="inline-flex items-center p-2 rounded-md bg-gray-800 border border-gray-600">
                        <input type="radio" name="ponto" value="1" class="form-radio text-green-600" checked>
                        <span class="ml-2">Primeiro Ponto (1)</span>
                    </label>
                    <label class="inline-flex items-center p-2 rounded-md bg-gray-800 border border-gray-600">
                        <input type="radio" name="ponto" value="2" class="form-radio text-green-600">
                        <span class="ml-2">Segundo Ponto (2)</span>
                    </label>
                </div>
            </div>
            <button id="gerarDadosBtn" class="w-full bg-green-600 text-white py-2 px-4 rounded-md shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200">
                GERAR DADOS
            </button>
        </div>

        <!-- Seção de Geração de Dados e Instruções - Visível após confirmação "Sim" e seleção do ponto -->
        <div id="generationResultsSection" class="space-y-4 hidden">
            <!-- Dados de Saída -->
            <div id="outputSection" class="space-y-4">
                <h2 class="text-xl font-semibold text-center">Dados Gerados</h2>
                <!-- Usuário -->
                <div>
                    <label class="block text-sm font-medium">USUÁRIO</label>
                    <div class="flex items-center mt-1">
                        <input type="text" id="usuarioOutput" readonly class="flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-l-md shadow-sm text-white focus:outline-none sm:text-sm">
                        <button class="copy-btn bg-gray-600 text-white py-2 px-4 rounded-r-md border border-l-0 border-gray-600 hover:bg-gray-700 focus:outline-none transition-colors duration-200" data-target="usuarioOutput">
                            Copiar
                        </button>
                    </div>
                </div>

                <!-- Senha -->
                <div>
                    <label class="block text-sm font-medium">SENHA</label>
                    <div class="flex items-center mt-1">
                        <input type="text" id="senhaOutput" readonly class="flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-l-md shadow-sm text-white focus:outline-none sm:text-sm">
                        <button class="copy-btn bg-gray-600 text-white py-2 px-4 rounded-r-md border border-l-0 border-gray-600 hover:bg-gray-700 focus:outline-none transition-colors duration-200" data-target="senhaOutput">
                            Copiar
                        </button>
                    </div>
                </div>

                <!-- Domínio -->
                <div>
                    <label class="block text-sm font-medium">DOMÍNIO</label>
                    <div class="flex items-center mt-1">
                        <input type="text" id="dominioOutput" readonly class="flex-1 px-3 py-2 bg-gray-700 border border-gray-600 rounded-l-md shadow-sm text-white focus:outline-none sm:text-sm">
                        <button class="copy-btn bg-gray-600 text-white py-2 px-4 rounded-r-md border border-l-0 border-gray-600 hover:bg-gray-700 focus:outline-none transition-colors duration-200" data-target="dominioOutput">
                            Copiar
                        </button>
                    </div>
                </div>
                
                <!-- Mensagem de cópia -->
                <div id="copyMessageBox" class="message-box hidden"></div>

                <!-- Seção de Envio de E-mail -->
                <div id="emailAndInstructionsSection">
                    <div class="mt-4 flex items-center justify-between">
                        <div class="flex items-center">
                            <input type="checkbox" id="sendEmailCheckbox" class="form-checkbox text-green-600 h-4 w-4">
                            <label for="sendEmailCheckbox" class="ml-2 text-sm font-medium">Enviar dados por e-mail?</label>
                        </div>
                    </div>
                    
                    <div id="emailInputContainer" class="mt-2 hidden">
                        <label for="email" class="block text-sm font-medium">E-mail</label>
                        <div class="flex items-center space-x-2">
                            <input type="email" id="email" class="flex-1 px-3 py-2 border border-gray-600 bg-gray-700 text-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm" placeholder="exemplo@exemplo.com">
                            <button id="sendEmailBtn" class="bg-green-600 text-white py-2 px-4 rounded-md shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200 text-sm disabled:bg-gray-400 disabled:cursor-not-allowed">
                                Enviar
                            </button>
                        </div>
                        <div id="emailMessage" class="message-box hidden"></div>
                    </div>
                </div>
            </div>

            <!-- Seção de Avisos e Instruções -->
            <div id="infoSection" class="mt-8 space-y-4 text-center">
                <div class="p-4 bg-yellow-800 rounded-lg shadow-sm border border-yellow-700 flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-yellow-300 mr-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.487 0l5.58 9.92c.754 1.346-.246 3.099-1.742 3.099H4.417c-1.496 0-2.498-1.753-1.742-3.099l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                    </svg>
                    <p class="text-sm font-medium text-yellow-300">
                        Não encontrou o e-mail? Ele pode estar na sua caixa de spam ou lixo eletrônico.
                    </p>
                </div>

                <div class="p-6 bg-gray-700 rounded-lg border border-gray-600 shadow-md space-y-4">
                    <h3 class="text-lg font-semibold">Como usar o interfone?</h3>
                    <ul class="text-left text-sm space-y-2 text-gray-300">
                        <li class="p-2 bg-gray-600 rounded-md">
                            Para ligar para a portaria, digite: <code class="font-bold text-white">94</code>
                        </li>
                        <li id="instrucaoFisico" class="p-2 bg-gray-600 rounded-md">
                            Para ligar para o seu interfone físico, digite: <code class="font-bold text-white"></code>
                        </li>
                        <li id="instrucaoInteligente" class="p-2 bg-gray-600 rounded-md">
                            Para ligar no seu interfone inteligente, digite: <code class="font-bold text-white"></code>
                        </li>
                    </ul>
                </div>

                <div class="p-4 bg-gray-700 rounded-lg shadow-sm border border-gray-600">
                    <p class="font-semibold mb-2">Ficou com alguma dúvida?</p>
                    <p class="text-sm">
                        Acione o suporte técnico via WhatsApp:
                    </p>
                    <a href="https://wa.me/551140205322" target="_blank" class="mt-2 inline-block px-4 py-2 bg-green-600 text-white font-medium text-sm rounded-md shadow-md hover:bg-green-700 transition-colors duration-200">
                        Abrir WhatsApp
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Mapeamento dos condomínios para domínios e senhas, consolidado das listas fornecidas
        const condominiumData = {
            "BENDORF": { domain: "bendorf.sc.loomy.srv.br", passwordPrefix: "rmt@bendorf" },
            "BRISAS DA SERRA 1 [1-4]": { domain: "brisasdaserra1.mg.loomy.srv.br", passwordPrefix: "rmt@brisas" },
            "BRISAS DA SERRA 2 [5-27]": { domain: "brisasdaserra2.mg.loomy.srv.br", passwordPrefix: "rmt@brisas02#" },
            "CHAPADA DOS LÍRIOS": { domain: "chapadadoslirios.mt.loomy.srv.br", passwordPrefix: "rmt@lirios" },
            "CHAPADA PANTANAL": { domain: "chapadapantanal.mt.loomy.srv.br", passwordPrefix: "rmt@loomy#" },
            "COSTA DO CACAU": { domain: "costadocacau.ba.loomy.srv.br", passwordPrefix: "rmt@loomy123#" },
            "ECOVILAGGIO": { domain: "ecovillagio.go.loomy.srv.br", passwordPrefix: "rmt@ecovilla" },
            "PONTO GARDÊNIA": { domain: "gardenia.mg.loomy.srv.br", passwordPrefix: "rmt@loomy2023" },
            "GRANCLUB": { domain: "granclub.go.loomy.srv.br", passwordPrefix: "rmt@loomy123#" },
            "GRAN SONATA": { domain: "gransonata.go.loomy.srv.br", passwordPrefix: "rmt@gransonata" },
            "GRAN VALEY": { domain: "granvalley.go.loomy.srv.br", passwordPrefix: "rmt@loomy123#" },
            "JOINVILLE": { domain: "joinville.sp.loomy.srv.br", passwordPrefix: "rmt@loomy123#" },
            "LAGOA DAS ESMERALDAS": { domain: "lagoadasesmeraldas.mg.loomy.srv.br", passwordPrefix: "rmt@loomy2023#" },
            "LIBRA": { domain: "libra.mg.loomy.srv.br", passwordPrefix: "rmt@loomy#2023" },
            "MAIS PARK": { domain: "maispark.mg.loomy.srv.br", passwordPrefix: "rmt@maispark" },
            "MARAJÓ": { domain: "marajo.mg.loomy.srv.br", passwordPrefix: "rmt@loomy123#" },
            "BOSQUE DAS MARGARIDAS": { domain: "margaridas.mg.loomy.srv.br", passwordPrefix: "rmt@loomy123#" },
            "MATA ATLÂNTICA": { domain: "mataatlantica.mg.loomy.srv.br", passwordPrefix: "rmt@loomy123#" },
            "MORADA CARIOCA": { domain: "moradacarioca.sp.loomy.srv.br", passwordPrefix: "rmt@loomy#123" },
            "MORADA DAS TORRES - CLUB": { domain: "moradadastorres.ba.loomy.srv.br", passwordPrefix: "rmt@moradaclub" },
            "MORADA DE MINAS": { domain: "moradademinas.mg.loomy.srv.br", passwordPrefix: "rmt@mdeminas" },
            "MORADA DAS TORRES SP": { domain: "moradadastorres.sp.loomy.srv.br", passwordPrefix: "rmt@loomy123#" },
            "MUSIQUE": { domain: "musique.mg.loomy.srv.br", passwordPrefix: "rmt@loomy123#" },
            "PLAZA NORTE": { domain: "plazanorte.mg.loomy.srv.br", passwordPrefix: "rmt@loomy#" },
            "LISBOA": { domain: "provinciaslisboa.mg.loomy.srv.br", passwordPrefix: "rmt@loomy" },
            "RESIDENCIAL SABIÁ": { domain: "residencialsabia.mg.loomy.srv.br", passwordPrefix: "rmt@loomy#2023" },
            "RIVERA LIFE": { domain: "riveralife.ba.loomy.srv.br", passwordPrefix: "rmt@rivera" },
            "RUBIS": { domain: "rubis.mg.loomy.srv.br", passwordPrefix: "rmt@loomy123#" },
            "SAN FELIPPO": { domain: "sanfelippo.sp.loomy.srv.br", passwordPrefix: "rmt@loomy2023#" },
            "SÃO FRANCISCO": { domain: "saofrancisco.mg.loomy.srv.br", passwordPrefix: "rmt@loomy2023#" },
            "SOLAR DOS MONTES": { domain: "solardosmontes.mg.loomy.srv.br", passwordPrefix: "rmt@loomy#2023" },
            "SOL DO ENGENHO": { domain: "soldoengenho.rj.loomy.srv.br", passwordPrefix: "rmt@engenho" },
            "SPAZIO SALVADOR NORTE": { domain: "spaziosalvadornorte.ba.loomy.srv.br", passwordPrefix: "rmt@spaziosalvador" },
            "SPAZIO SINGULAR": { domain: "spaziosingular.ba.loomy.srv.br", passwordPrefix: "rmt@loomy123#" },
            "JARDIM TIRADENTES": { domain: "tiradentes.mg.loomy.srv.br", passwordPrefix: "rmt@loomy2023" },
            "VIC PARK MONTREAL": { domain: "vicpark.mg.loomy.srv.br", passwordPrefix: "rmt@vic" },
            "VILA DIAMANTE": { domain: "viladiamante.es.loomy.srv.br", passwordPrefix: "rmt@loomy#26!" },
            "VILA REAL ESMERALDA": { domain: "vilarealesmeralda.mg.loomy.srv.br", passwordPrefix: "rmt@vilareal" },
            "VILLAS VILLAGE": { domain: "villasvillage.ba.loomy.srv.br", passwordPrefix: "rmt@villasvillage" },
            "RESERVA BARRA FUNDA": { domain: "reservabarrafunda.sp.loomy.srv.br", passwordPrefix: "rmt@reservabarrafunda" },
            "LUZ DO CAMPO": { domain: "luzdocampo.sp.loomy.srv.br", passwordPrefix: "rmt@luzdocampo" },
            "MORADA PREMIUM": { domain: "moradapremium.ba.loomy.srv.br", passwordPrefix: "rmt@moradapremium" },
            "PARQUE DAS NAÇÕES": { domain: "parquedasnacoes.ba.loomy.srv.br", passwordPrefix: "rmt@parquedasnacoes" },
            "PORTO DOURADO 2": { domain: "portodourado2.go.loomy.srv.br", passwordPrefix: "rmt@portodourado" },
            "PORTO DOURADO 3": { domain: "portodourado3.go.loomy.srv.br", passwordPrefix: "rmt@portodourado3" },
            "VILLAGE EUROPA": { domain: "villageeuropa.mg.loomy.srv.br", passwordPrefix: "rmt@villageeuropa" },
            "BOSQUE DAS ÁGUAS": { domain: "bosquedasaguas.mg.loomy.srv.br", passwordPrefix: "rmt@bosqueaguas" },
            "BOSQUE DA RIBEIRA": { domain: "bosquedaribeira.mg.loomy.srv.br", passwordPrefix: "rmt@ribeira" },
            "ESTRELA DE CRISTAL": { domain: "estreladecristal.loomy.srv.br", passwordPrefix: "rmt@cristal#" },
            "GOLDEN PLAZA": { domain: "goldenplaza.sp.loomy.srv.br", passwordPrefix: "rmt@golden" },
            "GREENVILLE": { domain: "greenville.mg.loomy.srv.br", passwordPrefix: "greenville@rmt" },
            "LAGUNA": { domain: "laguna.ba.loomy.srv.br", passwordPrefix: "rmt@laguna" },
            "RECANTO DOS ABRANTES": { domain: "recantodosabrantes.ba.loomy.srv.br", passwordPrefix: "rmt@abrantes" },
            "XINGÚ": { domain: "residencialxingu.mg.loomy.srv.br", passwordPrefix: "rmt@xingu" },
            "SERRA DOS PINHAIS": { domain: "serradospinhais.mg.loomy.srv.br", passwordPrefix: "Loomy@" },
            "VIVER FAMA": { domain: "viverfama.go.loomy.srv.br", passwordPrefix: "rmt@viverfama" },
            "PONTO DIAMANTE": { domain: "pontodiamante.mg.loomy.srv.br", passwordPrefix: "rmt@pontod" },
            "PONTO VEREDAS": { domain: "pontoveredas.mg.loomy.srv.br", passwordPrefix: "rmt@pontoveredas" },
            "FONTANA": { domain: "fontana.mg.loomy.srv.br", passwordPrefix: "rmt@biasca" },
            "PORTO DOURADO 2": { domain: "portodourado2.go.loomy.srv.br", passwordPrefix: "rmt@portodourado" },
            "CASA BRANCA": { domain: "casabranca.mg.loomy.srv.br", passwordPrefix: "rmt@casabranca" }
        };
        
        // Mapeamento de senhas especiais que não usam Bloco, Apartamento e Ponto
        const specialPasswordCondos = [
            "SAN FELIPPO", "SÃO FRANCISCO", "RESIDENCIAL SABIÁ", "JARDIM TIRADENTES",
            "LAGOA DAS ESMERALDAS", "SOLAR DOS MONTES", "LIBRA", "MORADA CARIOCA", "RUBIS",
            "MATA ATLÂNTICA", "COSTA DO CACAU", "SPAZIO SINGULAR", "BOSQUE DAS MARGARIDAS",
            "GRANCLUB", "GRAN VALEY", "JOINVILLE", "MUSIQUE", "MARAJÓ", "MORADA DAS TORRES SP",
            "PONTO GARDÊNIA", "SOLAR DO VALE", "PLAZA NORTE", "ESTRELA DE CRISTAL", "VILA DIAMANTE",
            "GOLDEN PLAZA", "SERRA DOS PINHAIS"
        ];
        
        // Referências para os elementos do DOM
        const authSection = document.getElementById('authSection');
        const dataConfirmationSection = document.getElementById('dataConfirmationSection');
        const pontoSelectionSection = document.getElementById('pontoSelectionSection');
        const generationResultsSection = document.getElementById('generationResultsSection');
        const mainButtonsContainer = document.getElementById('mainButtonsContainer');

        const avancarBtn = document.getElementById('avancarBtn');
        const devSkipBtn = document.getElementById('devSkipBtn');
        const confirmYesBtn = document.getElementById('confirmYesBtn');
        const confirmNoBtn = document.getElementById('confirmNoBtn');
        const gerarDadosBtn = document.getElementById('gerarDadosBtn');
        const sendEmailBtn = document.getElementById('sendEmailBtn');

        const loadingAnimation = document.getElementById('loadingAnimation');
        const authMessageBox = document.getElementById('authMessageBox');
        const confirmationMessageBox = document.getElementById('confirmationMessageBox');
        const copyMessageBox = document.getElementById('copyMessageBox');
        const emailMessage = document.getElementById('emailMessage');

        const nomeCompletoInput = document.getElementById('nomeCompleto');
        const cpfInput = document.getElementById('cpf');
        const numeroInput = document.getElementById('numero');

        const confirmedCondominio = document.getElementById('confirmedCondominio');
        const confirmedBloco = document.getElementById('confirmedBloco');
        const confirmedApartamento = document.getElementById('confirmedApartamento');

        const usuarioOutput = document.getElementById('usuarioOutput');
        const senhaOutput = document.getElementById('senhaOutput');
        const dominioOutput = document.getElementById('dominioOutput');

        const sendEmailCheckbox = document.getElementById('sendEmailCheckbox');
        const emailInputContainer = document.getElementById('emailInputContainer');
        const emailInput = document.getElementById('email');

        // Variáveis para armazenar os dados puxados da simulação
        let pulledCondominio = "";
        let pulledBloco = "";
        let pulledApartamento = "";

        // Função de máscara para CPF
        cpfInput.addEventListener('input', (e) => {
            let value = e.target.value.replace(/\D/g, ''); // Remove tudo que não é dígito
            value = value.slice(0, 11); // Limita a 11 dígitos
            value = value.replace(/(\d{3})(\d)/, '$1.$2'); // Adiciona o primeiro ponto
            value = value.replace(/(\d{3})(\d)/, '$1.$2'); // Adiciona o segundo ponto
            value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2'); // Adiciona o traço
            e.target.value = value;
        });

        // Função de máscara para Número de Telefone
        numeroInput.addEventListener('input', (e) => {
            let value = e.target.value.replace(/\D/g, ''); // Remove tudo que não é dígito
            value = value.slice(0, 11); // Limita a 11 dígitos
            
            if (value.length > 2) {
                value = value.replace(/^(\d{2})(\d)/g, '($1) $2'); // Adiciona parênteses e espaço
            }
            if (value.length > 9) {
                value = value.replace(/(\d{5})(\d{4})$/, '$1-$2'); // Adiciona traço para 9 dígitos
            } else if (value.length > 8) {
                value = value.replace(/(\d{4})(\d{4})$/, '$1-$2'); // Adiciona traço para 8 dígitos
            }

            e.target.value = value;
        });

        // Evento para o botão "Avançar"
        avancarBtn.addEventListener('click', async () => {
            const nomeCompleto = nomeCompletoInput.value.trim();
            const cpf = cpfInput.value.trim();
            const numero = numeroInput.value.trim();

            if (!nomeCompleto || !cpf || !numero) {
                showMessage(authMessageBox, "Por favor, preencha todos os campos de autenticação.", "error");
                return;
            }
            
            // Oculta os botões principais e exibe a animação de carregamento
            mainButtonsContainer.classList.add('hidden');
            loadingAnimation.classList.remove('hidden');
            hideMessage(authMessageBox);

            const apiResult = await mockIXCSoftApiCall(cpf);

            // Oculta a animação de carregamento
            loadingAnimation.classList.add('hidden');

            if (apiResult.success) {
                pulledCondominio = apiResult.data.condominio;
                pulledBloco = apiResult.data.bloco;
                pulledApartamento = apiResult.data.apartamento;

                authSection.classList.add('hidden');
                dataConfirmationSection.classList.remove('hidden');

                confirmedCondominio.textContent = pulledCondominio;
                confirmedBloco.textContent = pulledBloco;
                confirmedApartamento.textContent = pulledApartamento;

            } else {
                showMessage(authMessageBox, "Não foi possível encontrar seus dados. Tente novamente ou entre em contato com o suporte.", "error", true);
            }
        });

        // Evento para o botão "PULAR (DEV)"
        devSkipBtn.addEventListener('click', () => {
            pulledCondominio = "BENDORF";
            pulledBloco = "10";
            pulledApartamento = "101";

            authSection.classList.add('hidden');
            pontoSelectionSection.classList.remove('hidden');
            hideMessage(authMessageBox);
        });

        // Evento para o botão de confirmação "Sim, estes são meus dados"
        confirmYesBtn.addEventListener('click', () => {
            dataConfirmationSection.classList.add('hidden');
            pontoSelectionSection.classList.remove('hidden');
        });

        // Evento para o botão de confirmação "Não, não são meus dados"
        confirmNoBtn.addEventListener('click', () => {
            dataConfirmationSection.classList.add('hidden');
            authSection.classList.remove('hidden');
            showMessage(authMessageBox, "Os dados não correspondem. Por favor, tente novamente ou acione o suporte.", "error", true);
            
            // Garante que os botões de tentar e suporte apareçam
            mainButtonsContainer.classList.add('hidden');
        });
        
        // Evento para o botão "GERAR DADOS" na tela de seleção do ponto
        gerarDadosBtn.addEventListener('click', () => {
            const ponto = document.querySelector('input[name="ponto"]:checked');
            if (!ponto) {
                showMessage(confirmationMessageBox, "Por favor, selecione um ponto.", "error");
                return;
            }
            pontoSelectionSection.classList.add('hidden');
            generateAndDisplayData(pulledCondominio, pulledBloco, pulledApartamento, ponto.value);
        });

        // Função para gerar e exibir os dados
        function generateAndDisplayData(condominio, bloco, apartamento, ponto) {
            const condominioInfo = condominiumData[condominio];

            const usuario = `${bloco}${apartamento}${ponto}`;
            
            let senha;
            if (specialPasswordCondos.includes(condominio)) {
                senha = condominioInfo.passwordPrefix;
            } else if (condominio === "RESERVA BARRA FUNDA" && condominioInfo.passwordPrefix) {
                senha = `${condominioInfo.passwordPrefix}${bloco}${apartamento}0${ponto}`;
            } else {
                senha = `${condominioInfo.passwordPrefix}${bloco}${apartamento}${ponto}`;
            }

            const dominio = condominioInfo.domain;

            usuarioOutput.value = usuario;
            senhaOutput.value = senha;
            dominioOutput.value = dominio;

            document.querySelector('#instrucaoFisico code').textContent = `${bloco}${apartamento}`;
            document.querySelector('#instrucaoInteligente code').textContent = `${usuario}`;

            generationResultsSection.classList.remove('hidden');
        }

        // Função para simular a chamada de API do IXC Soft e retornar dados
        function mockIXCSoftApiCall(cpf) {
            return new Promise(resolve => {
                setTimeout(() => {
                    const sanitizedCpf = cpf.replace(/\D/g, '');
                    if (sanitizedCpf === "12345678900") { // CPF de teste para simular erro
                        resolve({ success: false, message: "Não foi possível encontrar seus dados no banco de dados." });
                    } else {
                        const mockData = {
                            condominio: "BENDORF",
                            bloco: "10",
                            apartamento: "101"
                        };
                        resolve({ success: true, message: "Autenticação bem-sucedida!", data: mockData });
                    }
                }, 3000); // 3 segundos de atraso para a animação
            });
        }
        
        // Evento para mostrar/esconder o campo de e-mail e habilitar o botão de envio
        sendEmailCheckbox.addEventListener('change', () => {
            if (sendEmailCheckbox.checked) {
                emailInputContainer.classList.remove('hidden');
                sendEmailBtn.disabled = !validateEmail(emailInput.value);
            } else {
                emailInputContainer.classList.add('hidden');
                hideMessage(emailMessage);
            }
        });

        // Evento para validar o e-mail e habilitar o botão de envio
        emailInput.addEventListener('input', () => {
            sendEmailBtn.disabled = !validateEmail(emailInput.value);
            if (!validateEmail(emailInput.value)) {
                showMessage(emailMessage, "O e-mail digitado não parece ser válido. Por favor, verifique e tente novamente.", "error");
            } else {
                hideMessage(emailMessage);
            }
        });

        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(String(email).toLowerCase());
        }
        
        // Evento para o botão de enviar e-mail
        sendEmailBtn.addEventListener('click', () => {
            const email = emailInput.value.trim();
            if (!validateEmail(email)) {
                showMessage(emailMessage, "Por favor, insira um e-mail válido.", "error");
                return;
            }
            
            const usuario = usuarioOutput.value;
            const senha = senhaOutput.value;
            const dominio = dominioOutput.value;

            showMessage(emailMessage, "Enviando...", "info");
            sendEmailBtn.disabled = true;

            setTimeout(() => {
                console.log(`Simulando envio de e-mail para ${email} com os dados gerados: Usuário=${usuario}, Senha=${senha}, Domínio=${dominio}`);
                showMessage(emailMessage, "Dados enviados para o e-mail!", "success");
                sendEmailBtn.disabled = false;
            }, 3000);
        });

        // Eventos para os botões de copiar
        document.querySelectorAll('.copy-btn').forEach(button => {
            button.addEventListener('click', (event) => {
                const targetId = event.target.dataset.target;
                const targetInput = document.getElementById(targetId);
                targetInput.select();
                try {
                    document.execCommand('copy');
                    showMessage(copyMessageBox, "Texto copiado para a área de transferência!", "success");
                } catch (err) {
                    console.error('Falha ao copiar: ', err);
                    // Usando a função showMessage para evitar alert()
                    showMessage(copyMessageBox, "Não foi possível copiar o texto. Por favor, copie manualmente.", "error");
                }
            });
        });

        function showMessage(element, text, type, showSupportButtons = false) {
            element.innerHTML = `<p>${text}</p>`;
            element.className = `message-box ${type}`;
            element.classList.remove('hidden');
            
            if (showSupportButtons) {
                const supportDiv = document.createElement('div');
                supportDiv.className = "mt-4 flex flex-col items-center space-y-2";
                supportDiv.innerHTML = `
                    <button id="tryAgainBtn" class="w-full bg-green-600 text-white py-2 px-4 rounded-md shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200">
                        Tentar Novamente
                    </button>
                    <a href="https://wa.me/551140205322" target="_blank" class="w-full text-center px-4 py-2 bg-green-500 text-white font-medium text-sm rounded-md shadow-md hover:bg-green-600 transition-colors duration-200">
                        Acionar Suporte
                    </a>
                `;
                element.appendChild(supportDiv);

                document.getElementById('tryAgainBtn').addEventListener('click', () => {
                    hideMessage(authMessageBox);
                    mainButtonsContainer.classList.remove('hidden');
                });
                
            } else if (type !== "info") {
                setTimeout(() => {
                    element.classList.add('hidden');
                }, 3000);
            }
        }

        function hideMessage(element) {
            element.classList.add('hidden');
        }
    </script>
</body>
</html>
